# üîç –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤ AI Chat

## –î–≤–∞ —Ä–∞–∑–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–∞ —Å –ø–æ—Ö–æ–∂–∏–º–∏ –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏

–í –ø—Ä–æ–µ–∫—Ç–µ –µ—Å—Ç—å –¥–≤–∞ —Å–µ—Ä–≤–∏—Å–∞, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å AI —á–∞—Ç–æ–º, —á—Ç–æ –º–æ–∂–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å –ø—É—Ç–∞–Ω–∏—Ü—É:

---

## 1. `ai_chat/` (–∫–æ—Ä–Ω–µ–≤–∞—è –ø–∞–ø–∫–∞) ‚Äî **–ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π AI Chat Service**

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
**–û—Ç–¥–µ–ª—å–Ω—ã–π –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å** –¥–ª—è –æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–æ–º —Å –ø–æ–ª–Ω—ã–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º.

### –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:
- ‚úÖ **–°–≤–æ–π –ø–æ—Ä—Ç**: 9001
- ‚úÖ **–°–≤–æ—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: PostgreSQL –¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏ —á–∞—Ç–∞ –∏ –ª–∏–º–∏—Ç–æ–≤
- ‚úÖ **–ê–≥–µ–Ω—Ç —Å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏**: Function calling —á–µ—Ä–µ–∑ `agent.py`
- ‚úÖ **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥–∞–Ω–Ω—ã–º–∏**: –î–æ—Å—Ç—É–ø –∫ —Ä–µ–∞–ª—å–Ω—ã–º –¥–∞–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–ø—Ä–æ–¥–∞–∂–∏, –∑–∞–∫–∞–∑—ã, –æ—Å—Ç–∞—Ç–∫–∏)
- ‚úÖ **–ò—Å—Ç–æ—Ä–∏—è —á–∞—Ç–∞**: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ –¥–∏–∞–ª–æ–≥–æ–≤
- ‚úÖ **–õ–∏–º–∏—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤**: 30 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å—É—Ç–∫–∏ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ **–ü–æ–ª–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞**: app/, tools/, tests/, docs/

### –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã:
- `POST /v1/chat/send` ‚Äî –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤ –ë–î
- `POST /v1/chat/history` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ —á–∞—Ç–∞
- `GET /v1/chat/limits/{telegram_id}` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–æ–≤
- `POST /v1/chat/reset-limit` ‚Äî —Å–±—Ä–æ—Å –ª–∏–º–∏—Ç–∞ (admin)
- `GET /v1/chat/stats/{telegram_id}` ‚Äî —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ **–±–æ—Ç** (`bot/handlers/ai_chat.py`):
```python
AI_CHAT_URL = "http://gpt:9000"
POST /v1/chat/send
```

---

## 2. `gpt_integration/ai_chat/` ‚Äî **–ü—Ä–æ—Å—Ç–æ–π –º–æ–¥—É–ª—å —á–∞—Ç–∞ –≤ GPT Integration**

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
**–ü—Ä–æ—Å—Ç–æ–π –º–æ–¥—É–ª—å** –≤–Ω—É—Ç—Ä–∏ `gpt_integration` —Å–µ—Ä–≤–∏—Å–∞ –¥–ª—è –±–∞–∑–æ–≤–æ–≥–æ —á–∞—Ç–∞ –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ª–æ–≥–∏–∫–∏.

### –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:
- ‚ö†Ô∏è **–í–Ω—É—Ç—Ä–∏ gpt_integration**: –†–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ –ø–æ—Ä—Ç 9000
- ‚ùå **–ù–µ—Ç –ë–î**: –ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏
- ‚ùå **–ù–µ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤**: –ü—Ä–æ—Å—Ç–æ –ø—Ä—è–º–æ–π –≤—ã–∑–æ–≤ GPT
- ‚ùå **–ù–µ—Ç –ª–∏–º–∏—Ç–æ–≤**: –ù–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚ùå **–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞**: –û–¥–∏–Ω —Ñ–∞–π–ª `service.py`

### –≠–Ω–¥–ø–æ–∏–Ω—Ç:
- `POST /v1/chat` ‚Äî –ø—Ä–æ—Å—Ç–æ–π —á–∞—Ç, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—Å—Ç –æ—Ç GPT

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
–†–µ–¥–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏–ª–∏ –ø—Ä–æ—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.

---

## üîÑ –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –ø–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥—É

### –ü—Ä–æ–±–ª–µ–º–∞:
–ü—É—Ç–∞–Ω–∏—Ü–∞ –≤ –Ω–∞–∑–≤–∞–Ω–∏—è—Ö ‚Äî –æ–±–∞ –Ω–∞–∑—ã–≤–∞—é—Ç—Å—è `ai_chat`, –Ω–æ —ç—Ç–æ —Ä–∞–∑–Ω—ã–µ –≤–µ—â–∏.

### –†–µ—à–µ–Ω–∏–µ 1: –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –º–æ–¥—É–ª—å –≤ `gpt_integration`

–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å `gpt_integration/ai_chat/` ‚Üí `gpt_integration/simple_chat/` –∏–ª–∏ `gpt_integration/basic_chat/`

**–ü–ª—é—Å—ã:**
- ‚úÖ –ü–æ–Ω—è—Ç–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ, –æ—Ç—Ä–∞–∂–∞—é—â–µ–µ —Å—É—Ç—å (–ø—Ä–æ—Å—Ç–æ–π —á–∞—Ç)
- ‚úÖ –ù–µ—Ç –ø—É—Ç–∞–Ω–∏—Ü—ã —Å –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–º —Å–µ—Ä–≤–∏—Å–æ–º
- ‚úÖ –Ø—Å–Ω–æ, —á—Ç–æ —ç—Ç–æ –º–æ–¥—É–ª—å –≤–Ω—É—Ç—Ä–∏ gpt_integration

**–ú–∏–Ω—É—Å—ã:**
- ‚ö†Ô∏è –ù—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã –≤ `service.py`

### –†–µ—à–µ–Ω–∏–µ 2: –£–¥–∞–ª–∏—Ç—å –º–æ–¥—É–ª—å, –µ—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

–ï—Å–ª–∏ `/v1/chat` –≤ gpt_integration –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–∫—Ç–∏–≤–Ω–æ, –º–æ–∂–Ω–æ –µ–≥–æ —É–¥–∞–ª–∏—Ç—å.

**–ü–ª—é—Å—ã:**
- ‚úÖ –£–ø—Ä–æ—â–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- ‚úÖ –ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞

**–ú–∏–Ω—É—Å—ã:**
- ‚ö†Ô∏è –ï—Å–ª–∏ –≥–¥–µ-—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –±—É–¥–µ—Ç –æ—à–∏–±–∫–∞

---

## üìä –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ | `ai_chat/` (–∫–æ—Ä–Ω–µ–≤–∞—è) | `gpt_integration/ai_chat/` |
|----------------|----------------------|----------------------------|
| **–¢–∏–ø** | –û—Ç–¥–µ–ª—å–Ω—ã–π –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å | –ú–æ–¥—É–ª—å –≤–Ω—É—Ç—Ä–∏ —Å–µ—Ä–≤–∏—Å–∞ |
| **–ü–æ—Ä—Ç** | 9001 | 9000 (—á–µ—Ä–µ–∑ gpt_integration) |
| **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** | ‚úÖ PostgreSQL | ‚ùå –ù–µ—Ç |
| **–ò—Å—Ç–æ—Ä–∏—è —á–∞—Ç–∞** | ‚úÖ –î–∞ | ‚ùå –ù–µ—Ç |
| **–õ–∏–º–∏—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤** | ‚úÖ –î–∞ (30/–¥–µ–Ω—å) | ‚ùå –ù–µ—Ç |
| **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã (tools)** | ‚úÖ –î–∞ (function calling) | ‚ùå –ù–µ—Ç |
| **–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è** | ‚úÖ –î–∞ (user_context) | ‚ùå –ù–µ—Ç |
| **–°—Ç—Ä—É–∫—Ç—É—Ä–∞** | app/, tools/, tests/ | service.py |
| **–≠–Ω–¥–ø–æ–∏–Ω—Ç—ã** | /v1/chat/send, /history, /limits | /v1/chat |
| **–û—Å–Ω–æ–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ** | –ß–µ—Ä–µ–∑ –±–æ—Ç–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π | –î–ª—è —Ç–µ—Å—Ç–æ–≤/–ø—Ä–æ—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ |

---

## ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è

**–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å `gpt_integration/ai_chat/` ‚Üí `gpt_integration/simple_chat/`**

–≠—Ç–æ:
1. –£—Å—Ç—Ä–∞–Ω–∏—Ç –ø—É—Ç–∞–Ω–∏—Ü—É –≤ –Ω–∞–∑–≤–∞–Ω–∏—è—Ö
2. –ü–æ–∫–∞–∂–µ—Ç, —á—Ç–æ —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ–π —á–∞—Ç, –∞ –Ω–µ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–∏—Å
3. –ù–µ –∑–∞—Ç—Ä–æ–Ω–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª (ai_chat/ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-11-03

