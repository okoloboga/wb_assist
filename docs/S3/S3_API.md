# üìò S3 API: –°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

## üéØ –¶–µ–ª—å —ç—Ç–∞–ø–∞

–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–æ—Ç–∞ –æ –∫–ª—é—á–µ–≤—ã—Ö —Å–æ–±—ã—Ç–∏—è—Ö Wildberries. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–æ—Å—Ç–∞–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ Telegram –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç —É—Å—Ç–æ–π—á–∏–≤—É—é —Ä–∞–±–æ—Ç—É –¥–∞–∂–µ –ø—Ä–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–±–æ—è—Ö –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π.

## üîî –¢–∏–ø—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è  | –°–æ–±—ã—Ç–∏–µ             | –û–ø–∏—Å–∞–Ω–∏–µ                      | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç   |
| ---------- | ------------------- | ----------------------------- | ----------- |
| üì¶ –ó–∞–∫–∞–∑—ã  | –ù–æ–≤—ã–π –∑–∞–∫–∞–∑         | –ù–æ–≤—ã–π –∑–∞–∫–∞–∑ –∑–∞ –ø–µ—Ä–∏–æ–¥         | –í—ã—Å–æ–∫–∏–π     |
| üì¶ –ó–∞–∫–∞–∑—ã  | –ó–∞–∫–∞–∑ –≤—ã–∫—É–ø–ª–µ–Ω      | –ó–∞–∫–∞–∑ –ø–µ—Ä–µ—à–µ–ª –≤ —Å—Ç–∞—Ç—É—Å "–≤—ã–∫—É–ø–ª–µ–Ω" | –í—ã—Å–æ–∫–∏–π |
| üì¶ –ó–∞–∫–∞–∑—ã  | –ó–∞–∫–∞–∑ –æ—Ç–º–µ–Ω–µ–Ω       | –ó–∞–∫–∞–∑ –ø–µ—Ä–µ—à–µ–ª –≤ —Å—Ç–∞—Ç—É—Å "–æ—Ç–º–µ–Ω–µ–Ω" | –í—ã—Å–æ–∫–∏–π |
| üì¶ –ó–∞–∫–∞–∑—ã  | –ó–∞–∫–∞–∑ –≤–æ–∑–≤—Ä–∞—â–µ–Ω     | –ó–∞–∫–∞–∑ –ø–µ—Ä–µ—à–µ–ª –≤ —Å—Ç–∞—Ç—É—Å "–≤–æ–∑–≤—Ä–∞—Ç" | –í—ã—Å–æ–∫–∏–π |
| ‚≠ê –û—Ç–∑—ã–≤—ã   | –ù–µ–≥–∞—Ç–∏–≤–Ω—ã–π –æ—Ç–∑—ã–≤    | –û—Ü–µ–Ω–∫–∞ 1‚Äì3‚òÖ                   | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π |
| üìâ –û—Å—Ç–∞—Ç–∫–∏ | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –æ—Å—Ç–∞—Ç–æ–∫ | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–∞ –Ω–∏–∂–µ –ø–æ—Ä–æ–≥–∞ | –í—ã—Å–æ–∫–∏–π     |

---

## üîÑ –ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –∏–∑ S2 API

### **1. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ–±—ã—Ç–∏–π (–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö)**

#### **GET /api/v1/bot/orders/recent**
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∑–∞–∫–∞–∑–æ–≤ –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å—Ç–∞—Ç—É—Å–∞  
**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –∑–∞–∫–∞–∑–æ–≤ –∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å—Ç–∞—Ç—É—Å–∞ (–≤—ã–∫—É–ø—ã, –æ—Ç–º–µ–Ω—ã, –≤–æ–∑–≤—Ä–∞—Ç—ã)  
**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `limit` (int, optional): –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 10)
- `offset` (int, optional): –°–º–µ—â–µ–Ω–∏–µ –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0)
- `include_status_changes` (bool, optional): –í–∫–ª—é—á–∏—Ç—å –∑–∞–∫–∞–∑—ã —Å –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ —Å—Ç–∞—Ç—É—Å–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é true)

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "data": {
    "orders": [
      {
        "id": 154,
        "date": "2025-10-03T12:48:00",
        "amount": 1410,
        "product_name": "–®–∏—Ñ–æ–Ω–æ–≤–∞—è –±–ª—É–∑–∫–∞ (S)",
        "brand": "SLAVALOOK BRAND",
        "warehouse_from": "–≠–ª–µ–∫—Ç—Ä–æ—Å—Ç–∞–ª—å",
        "warehouse_to": "–¶–§–û/–ú–æ—Å–∫–≤–∞",
        "commission_percent": 29.5,
        "rating": 4.8
      }
    ],
    "statistics": {
      "today_count": 19,
      "today_amount": 26790,
      "average_check": 1410,
      "growth_percent": 12,
      "amount_growth_percent": 8
    }
  }
}
```

#### **GET /api/v1/bot/reviews/summary**
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –æ—Ç–∑—ã–≤–æ–≤ –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏–π  
**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** –í—ã—è–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –æ—Ç–∑—ã–≤–æ–≤ –∏ –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã—Ö –æ—Ü–µ–Ω–æ–∫ (1-3‚òÖ)  
**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `limit` (int, optional): –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–∑—ã–≤–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 10)
- `offset` (int, optional): –°–º–µ—â–µ–Ω–∏–µ –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0)

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "data": {
    "new_reviews": [
      {
        "id": "154",
        "product_name": "–®–∏—Ñ–æ–Ω–æ–≤–∞—è –±–ª—É–∑–∫–∞",
        "rating": 5,
        "text": "–û—Ç–ª–∏—á–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ, –±—ã—Å—Ç—Ä–æ –¥–æ—Å—Ç–∞–≤–∏–ª–∏!",
        "time_ago": "2 —á–∞—Å–∞ –Ω–∞–∑–∞–¥",
        "order_id": 154
      }
    ],
    "statistics": {
      "average_rating": 4.8,
      "total_reviews": 214,
      "new_today": 5
    }
  }
}
```

#### **GET /api/v1/bot/stocks/critical**
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–ª—É—á–µ–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ—Å—Ç–∞—Ç–∫–æ–≤ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π  
**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ —Å –æ—Å—Ç–∞—Ç–∫–∞–º–∏ –Ω–∏–∂–µ –ø–æ—Ä–æ–≥–∞ (< 5 —à—Ç—É–∫)  
**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `limit` (int, optional): –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 20)
- `offset` (int, optional): –°–º–µ—â–µ–Ω–∏–µ –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0)

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "data": {
    "critical_products": [
      {
        "nm_id": 270591287,
        "name": "–®–∏—Ñ–æ–Ω–æ–≤–∞—è –±–ª—É–∑–∫–∞",
        "brand": "SLAVALOOK BRAND",
        "stocks": {
          "S": 13,
          "M": 1,
          "L": 0,
          "XL": 0
        },
        "critical_sizes": ["M"],
        "zero_sizes": ["L", "XL"],
        "sales_per_day": 29.29,
        "price": 1410,
        "commission_percent": 29.5,
        "days_left": {
          "M": 0,
          "S": 1
        }
      }
    ],
    "summary": {
      "critical_count": 2,
      "zero_count": 1,
      "attention_needed": 3,
      "potential_losses": 52.7
    }
  }
}
```

#### **GET /api/v1/bot/analytics/sales**
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –¥–ª—è –¥–Ω–µ–≤–Ω—ã—Ö —Å–≤–æ–¥–æ–∫  
**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–Ω–µ–≤–Ω—ã—Ö –æ—Ç—á–µ—Ç–æ–≤ (23:58)  
**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `period` (string, optional): –ü–µ—Ä–∏–æ–¥ –∞–Ω–∞–ª–∏–∑–∞ (7d, 30d, 90d, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 7d)

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "data": {
    "sales_periods": {
      "today": {"count": 19, "amount": 26790},
      "yesterday": {"count": 24, "amount": 33840},
      "7_days": {"count": 156, "amount": 234500},
      "30_days": {"count": 541, "amount": 892300},
      "90_days": {"count": 686, "amount": 1156800}
    },
    "dynamics": {
      "yesterday_growth_percent": -21,
      "week_growth_percent": 12,
      "average_check": 1410,
      "conversion_percent": 3.2
    },
    "top_products": [
      {
        "nm_id": 270591287,
        "name": "–®–∏—Ñ–æ–Ω–æ–≤–∞—è –±–ª—É–∑–∫–∞",
        "sales_count": 73,
        "sales_amount": 46800,
        "rating": 4.8,
        "stocks": {"S": 13, "M": 1, "L": 0, "XL": 0}
      }
    ]
  }
}
```

---

## üîß –ù–æ–≤—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è —Å–∏—Å—Ç–µ–º—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### **1. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π**

#### **GET /api/v1/bot/notifications/settings**
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è  
**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:** –ù–µ—Ç  
**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "data": {
    "user_id": 123456789,
    "notifications_enabled": true,
    "frequency": "5_minutes",
    "notification_types": {
      "new_orders": {
        "enabled": true,
        "priority": "HIGH"
      },
      "order_buyouts": {
        "enabled": true,
        "priority": "HIGH"
      },
      "order_cancellations": {
        "enabled": true,
        "priority": "HIGH"
      },
      "order_returns": {
        "enabled": true,
        "priority": "HIGH"
      },
      "negative_reviews": {
        "enabled": true,
        "priority": "CRITICAL"
      },
      "critical_stocks": {
        "enabled": true,
        "priority": "HIGH"
      }
    },
    "grouping": {
      "enabled": true,
      "max_group_size": 5,
      "group_timeout": 300
    }
  },
  "telegram_text": "üîî –ù–ê–°–¢–†–û–ô–ö–ò –£–í–ï–î–û–ú–õ–ï–ù–ò–ô\n\n‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤–∫–ª—é—á–µ–Ω—ã\n‚è∞ –ß–∞—Å—Ç–æ—Ç–∞: –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç\n\nüì¶ –ù–û–í–´–ï –ó–ê–ö–ê–ó–´: ‚úÖ –í–∫–ª—é—á–µ–Ω–æ (–í—ã—Å–æ–∫–∏–π)\nüí∞ –í–´–ö–£–ü–´: ‚úÖ –í–∫–ª—é—á–µ–Ω–æ (–í—ã—Å–æ–∫–∏–π)\n‚ùå –û–¢–ú–ï–ù–´: ‚úÖ –í–∫–ª—é—á–µ–Ω–æ (–í—ã—Å–æ–∫–∏–π)\nüîÑ –í–û–ó–í–†–ê–¢–´: ‚úÖ –í–∫–ª—é—á–µ–Ω–æ (–í—ã—Å–æ–∫–∏–π)\n‚ö†Ô∏è –ù–ï–ì–ê–¢–ò–í–ù–´–ï –û–¢–ó–´–í–´: ‚úÖ –í–∫–ª—é—á–µ–Ω–æ (–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π)\nüìâ –û–°–¢–ê–¢–ö–ò: ‚úÖ –í–∫–ª—é—á–µ–Ω–æ (–í—ã—Å–æ–∫–∏–π)\n\nüí° –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞: –≤–∫–ª—é—á–µ–Ω–∞ (–¥–æ 5 —Å–æ–æ–±—â–µ–Ω–∏–π, 5 –º–∏–Ω)"
}
```

#### **POST /api/v1/bot/notifications/settings**
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π  
**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```json
{
  "notifications_enabled": true,
  "frequency": "5_minutes",
  "notification_types": {
    "new_orders": {"enabled": true, "priority": "HIGH"},
    "order_buyouts": {"enabled": true, "priority": "HIGH"},
    "order_cancellations": {"enabled": true, "priority": "HIGH"},
    "order_returns": {"enabled": true, "priority": "HIGH"},
    "negative_reviews": {"enabled": true, "priority": "CRITICAL"},
    "critical_stocks": {"enabled": true, "priority": "HIGH"}
  },
  "grouping": {
    "enabled": true,
    "max_group_size": 5,
    "group_timeout": 300
  }
}
```
**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "data": {
    "updated_at": "2025-01-28T14:30:15",
    "changes_count": 3
  },
  "telegram_text": "‚úÖ –ù–ê–°–¢–†–û–ô–ö–ò –û–ë–ù–û–í–õ–ï–ù–´\n\nüîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è: –≤–∫–ª—é—á–µ–Ω—ã\n‚è∞ –ß–∞—Å—Ç–æ—Ç–∞: –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç\n\nüì¶ –ù–æ–≤—ã–µ –∑–∞–∫–∞–∑—ã: ‚úÖ –í–∫–ª—é—á–µ–Ω–æ\nüí∞ –í—ã–∫—É–ø—ã: ‚úÖ –í–∫–ª—é—á–µ–Ω–æ\n‚ùå –û—Ç–º–µ–Ω—ã: ‚úÖ –í–∫–ª—é—á–µ–Ω–æ\nüîÑ –í–æ–∑–≤—Ä–∞—Ç—ã: ‚úÖ –í–∫–ª—é—á–µ–Ω–æ\n‚ö†Ô∏è –ù–µ–≥–∞—Ç–∏–≤–Ω—ã–µ –æ—Ç–∑—ã–≤—ã: ‚úÖ –í–∫–ª—é—á–µ–Ω–æ\nüìâ –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –æ—Å—Ç–∞—Ç–∫–∏: ‚úÖ –í–∫–ª—é—á–µ–Ω–æ\n\nüí° –ò–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –∏ –≤—Å—Ç—É–ø—è—Ç –≤ —Å–∏–ª—É –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ"
}
```

### **2. –ò—Å—Ç–æ—Ä–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π**

#### **GET /api/v1/bot/notifications/history**
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–ª—É—á–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è  
**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `limit` (int, optional): –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 20)
- `offset` (int, optional): –°–º–µ—â–µ–Ω–∏–µ –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0)
- `type` (string, optional): –§–∏–ª—å—Ç—Ä –ø–æ —Ç–∏–ø—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- `date_from` (string, optional): –î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ (YYYY-MM-DD)
- `date_to` (string, optional): –î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è (YYYY-MM-DD)

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "data": {
    "notifications": [
      {
        "id": "notif_12345",
        "type": "new_order",
        "priority": "HIGH",
        "title": "–ù–æ–≤—ã–π –∑–∞–∫–∞–∑ #154",
        "content": "–®–∏—Ñ–æ–Ω–æ–≤–∞—è –±–ª—É–∑–∫–∞ (S) | 1410‚ÇΩ",
        "sent_at": "2025-01-28T12:48:00",
        "status": "delivered",
        "delivery_time": "2025-01-28T12:48:02",
        "retry_count": 0
      },
      {
        "id": "notif_12346",
        "type": "order_buyout",
        "priority": "HIGH",
        "title": "–ó–∞–∫–∞–∑ –≤—ã–∫—É–ø–ª–µ–Ω #154",
        "content": "–®–∏—Ñ–æ–Ω–æ–≤–∞—è –±–ª—É–∑–∫–∞ (S) | 1410‚ÇΩ ‚Üí –í—ã–∫—É–ø–ª–µ–Ω",
        "sent_at": "2025-01-28T13:15:00",
        "status": "delivered",
        "delivery_time": "2025-01-28T13:15:01",
        "retry_count": 0
      },
      {
        "id": "notif_12347",
        "type": "order_cancellation",
        "priority": "HIGH",
        "title": "–ó–∞–∫–∞–∑ –æ—Ç–º–µ–Ω–µ–Ω #155",
        "content": "–î–∂–∏–Ω—Å—ã –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ (M) | 890‚ÇΩ ‚Üí –û—Ç–º–µ–Ω–µ–Ω",
        "sent_at": "2025-01-28T14:20:00",
        "status": "delivered",
        "delivery_time": "2025-01-28T14:20:01",
        "retry_count": 0
      },
      {
        "id": "notif_12348",
        "type": "order_return",
        "priority": "HIGH",
        "title": "–ó–∞–∫–∞–∑ –≤–æ–∑–≤—Ä–∞—â–µ–Ω #153",
        "content": "–ü–ª–∞—Ç—å–µ –≤–µ—á–µ—Ä–Ω–µ–µ (L) | 2340‚ÇΩ ‚Üí –í–æ–∑–≤—Ä–∞—Ç",
        "sent_at": "2025-01-28T15:30:00",
        "status": "delivered",
        "delivery_time": "2025-01-28T15:30:01",
        "retry_count": 0
      },
      {
        "id": "notif_12349",
        "type": "critical_stocks",
        "priority": "HIGH",
        "title": "–ö—Ä–∏—Ç–∏—á–Ω—ã–µ –æ—Å—Ç–∞—Ç–∫–∏",
        "content": "–®–∏—Ñ–æ–Ω–æ–≤–∞—è –±–ª—É–∑–∫–∞: M(1) - –Ω–∞ 0 –¥–Ω–µ–π!",
        "sent_at": "2025-01-28T11:30:00",
        "status": "delivered",
        "delivery_time": "2025-01-28T11:30:01",
        "retry_count": 0
      }
    ],
    "statistics": {
      "total_notifications": 45,
      "delivered": 44,
      "failed": 1,
      "average_delivery_time": 1.2,
      "success_rate": 97.8
    },
    "pagination": {
      "limit": 20,
      "offset": 0,
      "total": 45,
      "has_more": true
    }
  },
  "telegram_text": "üìã –ò–°–¢–û–†–ò–Ø –£–í–ï–î–û–ú–õ–ï–ù–ò–ô\n\nüÜï –ù–û–í–´–ô –ó–ê–ö–ê–ó #154 | 12:48\n   –®–∏—Ñ–æ–Ω–æ–≤–∞—è –±–ª—É–∑–∫–∞ (S) | 1410‚ÇΩ\n   ‚úÖ –î–æ—Å—Ç–∞–≤–ª–µ–Ω–æ (0.2—Å)\n\nüí∞ –í–´–ö–£–ü #154 | 13:15\n   –®–∏—Ñ–æ–Ω–æ–≤–∞—è –±–ª—É–∑–∫–∞ (S) | 1410‚ÇΩ ‚Üí –í—ã–∫—É–ø–ª–µ–Ω\n   ‚úÖ –î–æ—Å—Ç–∞–≤–ª–µ–Ω–æ (0.1—Å)\n\n‚ùå –û–¢–ú–ï–ù–ê #155 | 14:20\n   –î–∂–∏–Ω—Å—ã –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ (M) | 890‚ÇΩ ‚Üí –û—Ç–º–µ–Ω–µ–Ω\n   ‚úÖ –î–æ—Å—Ç–∞–≤–ª–µ–Ω–æ (0.1—Å)\n\nüîÑ –í–û–ó–í–†–ê–¢ #153 | 15:30\n   –ü–ª–∞—Ç—å–µ –≤–µ—á–µ—Ä–Ω–µ–µ (L) | 2340‚ÇΩ ‚Üí –í–æ–∑–≤—Ä–∞—Ç\n   ‚úÖ –î–æ—Å—Ç–∞–≤–ª–µ–Ω–æ (0.1—Å)\n\n‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ù–´–ï –û–°–¢–ê–¢–ö–ò | 11:30\n   –®–∏—Ñ–æ–Ω–æ–≤–∞—è –±–ª—É–∑–∫–∞: M(1) - –Ω–∞ 0 –¥–Ω–µ–π!\n   ‚úÖ –î–æ—Å—Ç–∞–≤–ª–µ–Ω–æ (0.1—Å)\n\nüìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê\n‚Ä¢ –í—Å–µ–≥–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π: 45\n‚Ä¢ –î–æ—Å—Ç–∞–≤–ª–µ–Ω–æ: 44 (97.8%)\n‚Ä¢ –ù–µ—É–¥–∞—á–Ω—ã—Ö: 1\n‚Ä¢ –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –¥–æ—Å—Ç–∞–≤–∫–∏: 1.2—Å\n\nüí° –ü–æ–∫–∞–∑–∞–Ω–æ 20 –∏–∑ 45 —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π"
}
```

### **3. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—á–µ—Ä–µ–¥—å—é —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π**

#### **GET /api/v1/bot/notifications/queue/status**
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°—Ç–∞—Ç—É—Å –æ—á–µ—Ä–µ–¥–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π  
**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:** –ù–µ—Ç  
**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "data": {
    "queue_status": "active",
    "pending_notifications": 3,
    "processing_rate": "2.5/sec",
    "average_wait_time": "0.8s",
    "queue_health": "good",
    "last_processed": "2025-01-28T14:29:45",
    "errors_last_hour": 0,
    "retry_queue": 0
  },
  "telegram_text": "üîÑ –°–¢–ê–¢–£–° –û–ß–ï–†–ï–î–ò –£–í–ï–î–û–ú–õ–ï–ù–ò–ô\n\n‚úÖ –û—á–µ—Ä–µ–¥—å –∞–∫—Ç–∏–≤–Ω–∞\n‚è≥ –û–∂–∏–¥–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏: 3\nüìà –°–∫–æ—Ä–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏: 2.5/—Å–µ–∫\n‚è±Ô∏è –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è: 0.8—Å\nüíö –°–æ—Å—Ç–æ—è–Ω–∏–µ: –æ—Ç–ª–∏—á–Ω–æ–µ\n\nüïê –ü–æ—Å–ª–µ–¥–Ω—è—è –æ–±—Ä–∞–±–æ—Ç–∫–∞: 14:29:45\n‚ùå –û—à–∏–±–æ–∫ –∑–∞ —á–∞—Å: 0\nüîÑ –ü–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫: 0"
}
```

#### **POST /api/v1/bot/notifications/queue/clear**
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û—á–∏—Å—Ç–∫–∞ –æ—á–µ—Ä–µ–¥–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è)  
**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:** –ù–µ—Ç  
**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "data": {
    "cleared_count": 3,
    "cleared_at": "2025-01-28T14:30:15"
  },
  "telegram_text": "üßπ –û–ß–ï–†–ï–î–¨ –û–ß–ò–©–ï–ù–ê\n\nüóëÔ∏è –£–¥–∞–ª–µ–Ω–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π: 3\nüïê –í—Ä–µ–º—è –æ—á–∏—Å—Ç–∫–∏: 14:30:15\n\nüí° –û—á–µ—Ä–µ–¥—å –≥–æ—Ç–æ–≤–∞ –∫ –Ω–æ–≤—ã–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º"
}
```

### **4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π**

#### **POST /api/v1/bot/notifications/test**
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è  
**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```json
{
  "type": "order_buyout",
  "test_data": {
    "order_id": 999,
    "product_name": "–¢–µ—Å—Ç–æ–≤—ã–π —Ç–æ–≤–∞—Ä",
    "amount": 1000,
    "previous_status": "active",
    "new_status": "buyout"
  }
}
```
**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "data": {
    "test_notification_id": "test_12345",
    "sent_at": "2025-01-28T14:30:15",
    "delivery_time": "2025-01-28T14:30:16",
    "status": "delivered"
  },
  "telegram_text": "üß™ –¢–ï–°–¢–û–í–û–ï –£–í–ï–î–û–ú–õ–ï–ù–ò–ï\n\nüí∞ –í–´–ö–£–ü #999\n   –¢–µ—Å—Ç–æ–≤—ã–π —Ç–æ–≤–∞—Ä | 1000‚ÇΩ\n   –°—Ç–∞—Ç—É—Å: –∞–∫—Ç–∏–≤–Ω—ã–π ‚Üí –≤—ã–∫—É–ø–ª–µ–Ω\n\n‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ\nüÜî ID: test_12345\nüïê –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ: 14:30:15\nüì® –î–æ—Å—Ç–∞–≤–ª–µ–Ω–æ: 14:30:16\n‚è±Ô∏è –í—Ä–µ–º—è –¥–æ—Å—Ç–∞–≤–∫–∏: 1.0—Å\n\nüí° –ï—Å–ª–∏ –≤—ã –ø–æ–ª—É—á–∏–ª–∏ —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ, —Å–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ"
}
```


---

## üîÑ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**

1. **Event Detector** - –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –¥–∞–Ω–Ω—ã—Ö WB (–Ω–æ–≤—ã–µ –∑–∞–∫–∞–∑—ã, –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞)
2. **Status Change Monitor** - –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–æ–≤ (–≤—ã–∫—É–ø—ã, –æ—Ç–º–µ–Ω—ã, –≤–æ–∑–≤—Ä–∞—Ç—ã)
3. **Notification Generator** - –°–æ–∑–¥–∞–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–æ–±—ã—Ç–∏–π
4. **Queue Manager** - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—á–µ—Ä–µ–¥—å—é —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (Redis)
5. **Delivery Service** - –î–æ—Å—Ç–∞–≤–∫–∞ —á–µ—Ä–µ–∑ Telegram
6. **Settings Manager** - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
7. **History Tracker** - –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### **–ü–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö:**

```
WB API ‚Üí Event Detector ‚Üí Status Change Monitor ‚Üí Notification Generator ‚Üí Queue Manager ‚Üí Delivery Service ‚Üí Telegram
                ‚Üì                    ‚Üì
        Settings Manager ‚Üê History Tracker
```

### **Redis —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:**

- `notifications:queue` - –û—á–µ—Ä–µ–¥—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- `notifications:settings:{user_id}` - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `notifications:history:{user_id}` - –ò—Å—Ç–æ—Ä–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- `notifications:state:{user_id}` - –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–µ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
- `notifications:order_status:{user_id}` - –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Å—Ç–∞—Ç—É—Å—ã –∑–∞–∫–∞–∑–æ–≤ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
- `notifications:status_changes:{user_id}` - –û—á–µ—Ä–µ–¥—å –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–æ–≤

---

## üìä –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏

### **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
- **–ß–∞—Å—Ç–æ—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏:** –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
- **–í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏—è:** < 2 —Å–µ–∫—É–Ω–¥
- **–í—Ä–µ–º—è –¥–æ—Å—Ç–∞–≤–∫–∏:** < 5 —Å–µ–∫—É–Ω–¥
- **–ü—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å:** –¥–æ 1000 —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π/–º–∏–Ω—É—Ç—É
- **–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤:** –¥–æ 10,000 –∑–∞–∫–∞–∑–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- **–î–µ—Ç–µ–∫—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π:** < 1 —Å–µ–∫—É–Ω–¥–∞ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:**
- **Retry –ª–æ–≥–∏–∫–∞:** 5 –ø–æ–ø—ã—Ç–æ–∫ —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π
- **–û—á–µ—Ä–µ–¥—å:** Redis —Å –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å—é
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:** –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- **Fallback:** –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ Telegram
- **–°—Ç–∞—Ç—É—Å-—Ç—Ä–µ–∫–∏–Ω–≥:** –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤ –≤ Redis
- **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ–± –æ–¥–Ω–æ–º —Å–æ–±—ã—Ç–∏–∏

### **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å:**
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è
- **–û—á–µ—Ä–µ–¥–∏:** Redis –∫–ª–∞—Å—Ç–µ—Ä
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** PostgreSQL –¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏
- **–ö—ç—à:** Redis –¥–ª—è —Å–æ—Å—Ç–æ—è–Ω–∏—è
- **–°—Ç–∞—Ç—É—Å-—Ö—Ä–∞–Ω–∏–ª–∏—â–µ:** Redis –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –∑–∞–∫–∞–∑–æ–≤
- **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞:** –î–æ 100 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ

---

*–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: 2025-01-28*
*–í–µ—Ä—Å–∏—è API: S3.01*
*‚úÖ –°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≥–æ—Ç–æ–≤–∞ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏*
*‚úÖ –í—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã*
*‚úÖ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∞*
*‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—ã–∫—É–ø–æ–≤, –æ—Ç–º–µ–Ω –∏ –≤–æ–∑–≤—Ä–∞—Ç–æ–≤*
*‚úÖ –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–æ–≤*
