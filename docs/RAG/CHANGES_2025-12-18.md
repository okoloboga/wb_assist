# RAG Changes - 2025-12-18

**–î–∞—Ç–∞:** 2025-12-18
**–í–µ—Ä—Å–∏—è:** RAG v1.2.0
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É

---

## üéâ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 1. ‚úÖ –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è (–∫—Ä–∏—Ç–∏—á–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ)

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–∞–ª–∞ AI-—Å–µ—Ä–≤–∏—Å –Ω–∞ 3+ –º–∏–Ω—É—Ç—ã
- –î—Ä—É–≥–∏–µ –∑–∞–ø—Ä–æ—Å—ã (–∞–Ω–∞–ª–∏—Ç–∏–∫–∞, —á–∞—Ç) –Ω–µ –º–æ–≥–ª–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å—Å—è
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏—Å–ø—ã—Ç—ã–≤–∞–ª–∏ –∑–∞–¥–µ—Ä–∂–∫–∏

**–†–µ—à–µ–Ω–∏–µ:**
- API endpoint `/v1/rag/index/{cabinet_id}` —Ç–µ–ø–µ—Ä—å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç **202 Accepted** —Å—Ä–∞–∑—É
- –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ —Ñ–æ–Ω–µ —á–µ—Ä–µ–∑ `asyncio.create_task()`

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚ö° –ù–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ AI-—Å–µ—Ä–≤–∏—Å–∞
- üöÄ –î—Ä—É–≥–∏–µ –∑–∞–ø—Ä–æ—Å—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
- üìä –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —á–µ—Ä–µ–∑ `/v1/rag/status/{cabinet_id}`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ:**
- `gpt_integration/ai_chat/RAG/api.py`:
  - –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `_background_indexing()`
  - Endpoint `trigger_indexing()` —Ç–µ–ø–µ—Ä—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 202
  - –£–ª—É—á—à–µ–Ω endpoint `get_indexing_status()`

---

### 2. ‚úÖ –ü–µ—Ä–≤–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è ‚Üí Full Rebuild

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ü–µ—Ä–≤–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–∞–±–∏–Ω–µ—Ç–∞ –∑–∞–ø—É—Å–∫–∞–ª–∞ "incremental" –≤–º–µ—Å—Ç–æ "full_rebuild"
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª–∞ –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –º–µ–¥–ª–µ–Ω–Ω–æ (9932 —á–∞–Ω–∫–æ–≤ –∑–∞ 201 —Å–µ–∫—É–Ω–¥—É)
- –†–µ–∂–∏–º incremental –¥–µ–ª–∞–µ—Ç –ª–∏—à–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ hash

**–†–µ—à–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–ª–µ–Ω —Ñ–ª–∞–≥ `is_first_sync` –≤ WB sync
- –ü—Ä–∏ –ø–µ—Ä–≤–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ç—Ä–∏–≥–≥–µ—Ä–∏—Ç—Å—è `full_rebuild=True`

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- üöÄ –ë—ã—Å—Ç—Ä–µ–µ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ä–µ–∂–∏–º –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–ª—É—á–∞—è
- üìà –û–ø—Ç–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ:**
- `server/app/features/wb_api/sync_service.py`:
  - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `is_first_sync` (—Å—Ç—Ä–æ–∫–∞ 71)
  - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ (—Å—Ç—Ä–æ–∫–∞ 174)
- `server/app/features/sync/tasks.py`:
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ `is_first_sync` (—Å—Ç—Ä–æ–∫–∞ 57)
  - –¢—Ä–∏–≥–≥–µ—Ä `full_rebuild=True` –¥–ª—è –ø–µ—Ä–≤–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ (—Å—Ç—Ä–æ–∫–∞ 62)

---

### 3. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ `remaining_requests: None`

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ü—Ä–∏ –±–µ–∑–ª–∏–º–∏—Ç–Ω–æ–º —Ä–µ–∂–∏–º–µ (`RAG_USAGE=0`) –≤–æ–∑–≤—Ä–∞—â–∞–ª–æ—Å—å `None`
- Pydantic –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞–¥–∞–ª–∞ —Å –æ—à–∏–±–∫–æ–π `int_type`
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –º–æ–≥–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —á–∞—Ç

**–†–µ—à–µ–Ω–∏–µ:**
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è `-1` –≤–º–µ—Å—Ç–æ `None` –¥–ª—è –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—è –±–µ–∑–ª–∏–º–∏—Ç–∞
- –û–±–Ω–æ–≤–ª–µ–Ω—ã —Å—Ö–µ–º—ã Pydantic
- –û–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –º–µ—Ç–æ–¥–æ–≤

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ë–µ–∑–ª–∏–º–∏—Ç–Ω—ã–π —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- üìù –ü–æ–Ω—è—Ç–Ω–∞—è —Å–µ–º–∞–Ω—Ç–∏–∫–∞: `-1` = unlimited
- üîß –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å API

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ:**
- `gpt_integration/ai_chat/app/crud.py`:
  - `check_and_update_limit()`: –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `-1` (—Å—Ç—Ä–æ–∫–∞ 73)
  - `get_limits()`: –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `-1` (—Å—Ç—Ä–æ–∫–∞ 134)
- `gpt_integration/ai_chat/app/schemas.py`:
  - –£–±—Ä–∞–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è `ge=0` –¥–ª—è `remaining_requests`
  - –û–±–Ω–æ–≤–ª–µ–Ω–æ –æ–ø–∏—Å–∞–Ω–∏–µ: "(-1 for unlimited)"

---

## üìä –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏

### –î–æ (–°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è):
```
Celery Task
  ‚Üì
HTTP POST /v1/rag/index/1
  ‚Üì
await indexer.index_cabinet()  ‚è≥ 3+ –º–∏–Ω—É—Ç—ã (–±–ª–æ–∫–∏—Ä—É–µ—Ç!)
  ‚Üì
200 OK
```

**–ü—Ä–æ–±–ª–µ–º–∞:** AI-—Å–µ—Ä–≤–∏—Å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω, –¥—Ä—É–≥–∏–µ –∑–∞–ø—Ä–æ—Å—ã –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è.

### –ü–æ—Å–ª–µ (–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è):
```
Celery Task
  ‚Üì
HTTP POST /v1/rag/index/1
  ‚Üì
–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞ (409 –µ—Å–ª–∏ —É–∂–µ –∏–¥–µ—Ç)
  ‚Üì
asyncio.create_task(background_indexing)  ‚ö° –§–æ–Ω
  ‚Üì
202 Accepted (—Å—Ä–∞–∑—É!)

–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ:
  - background_indexing ‚Üí –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è –≤ —Ñ–æ–Ω–µ
  - AI-—Å–µ—Ä–≤–∏—Å ‚Üí –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥—Ä—É–≥–∏–µ –∑–∞–ø—Ä–æ—Å—ã
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:** –ù–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏, –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ.

---

## üîÑ –§–ª–æ—É –ø–µ—Ä–≤–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

### –î–æ:
```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–±–∞–≤–ª—è–µ—Ç –∫–∞–±–∏–Ω–µ—Ç
2. WB sync: –ø–µ—Ä–≤–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è (–∑–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö)
3. RAG trigger: incremental mode ‚ùå
4. –û–±—Ä–∞–±–æ—Ç–∫–∞ 9932 —á–∞–Ω–∫–æ–≤ –º–µ–¥–ª–µ–Ω–Ω–æ (201 —Å–µ–∫)
```

### –ü–æ—Å–ª–µ:
```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–±–∞–≤–ª—è–µ—Ç –∫–∞–±–∏–Ω–µ—Ç
2. WB sync: –ø–µ—Ä–≤–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è (is_first_sync=True)
3. RAG trigger: full_rebuild mode ‚úÖ
4. –û–ø—Ç–∏–º–∞–ª—å–Ω–∞—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è –≤ —Ñ–æ–Ω–µ
5. AI-—Å–µ—Ä–≤–∏—Å –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –¥—Ä—É–≥–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
```

---

## üìã API Changes

### POST `/v1/rag/index/{cabinet_id}`

**–°—Ç–∞—Ä—ã–π –æ—Ç–≤–µ—Ç (200 OK):**
```json
{
  "status": "success",
  "message": "–ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞",
  "total_chunks": 9932,
  "metrics": {...}
}
```

**–ù–æ–≤—ã–π –æ—Ç–≤–µ—Ç (202 Accepted):**
```json
{
  "status": "accepted",
  "message": "–ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –∫–∞–±–∏–Ω–µ—Ç–∞ 1 –∑–∞–ø—É—â–µ–Ω–∞ –≤ —Ñ–æ–Ω–µ",
  "cabinet_id": 1,
  "indexing_mode": "full_rebuild",
  "note": "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ GET /v1/rag/status/1 –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞"
}
```

**–ù–æ–≤—ã–µ –∫–æ–¥—ã –æ—Ç–≤–µ—Ç–∞:**
- `202 Accepted` - –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è –∑–∞–ø—É—â–µ–Ω–∞ –≤ —Ñ–æ–Ω–µ ‚úÖ
- `409 Conflict` - –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è —É–∂–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è ‚ö†Ô∏è

---

### GET `/v1/rag/status/{cabinet_id}`

**–£–ª—É—á—à–µ–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç:**
```json
{
  "status": "success",
  "cabinet_id": 1,
  "indexing_status": "in_progress",
  "is_indexing": true,
  "last_indexed_at": "2025-12-18T03:47:24+00:00",
  "last_incremental_at": "2025-12-18T03:47:24+00:00",
  "total_chunks": 9932,
  "created_at": "2025-12-18T03:44:04+00:00",
  "updated_at": "2025-12-18T03:47:25+00:00",
  "message": "–ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è..."
}
```

**–ù–æ–≤—ã–µ –ø–æ–ª—è:**
- `is_indexing` - –±—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞: –∏–¥–µ—Ç –ª–∏ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è —Å–µ–π—á–∞—Å
- `last_incremental_at` - –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–π –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–π –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏
- `message` - –ø–æ–Ω—è—Ç–Ω–æ–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ

---

## üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—é

### 1. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å—ã:
```bash
docker-compose restart gpt server celery-worker celery-worker-rag
```

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
```bash
# AI-—Å–µ—Ä–≤–∏—Å
docker-compose logs -f gpt | grep -E "(Background indexing|202 Accepted)"

# Celery worker
docker-compose logs -f celery-worker-rag
```

### 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

#### –¢–µ—Å—Ç 1: –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—é
curl -X POST "http://localhost:9000/v1/rag/index/1" \
  -H "X-API-KEY: $API_SECRET_KEY"

# –û—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–º: 202 Accepted
# –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ —Ñ–æ–Ω–µ

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
curl "http://localhost:9000/v1/rag/status/1" \
  -H "X-API-KEY: $API_SECRET_KEY"
```

#### –¢–µ—Å—Ç 2: –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
```bash
# –í–æ –≤—Ä–µ–º—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –∞–Ω–∞–ª–∏—Ç–∏–∫—É
# –î–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –∑–∞–¥–µ—Ä–∂–µ–∫!
```

#### –¢–µ—Å—Ç 3: –ü–µ—Ä–≤–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
```bash
# –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –∫–∞–±–∏–Ω–µ—Ç
# –î–æ–ª–∂–Ω–∞ –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è full_rebuild –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: "Triggering FULL rebuild RAG indexing"
```

---

## ‚ö†Ô∏è Breaking Changes

### API –ò–∑–º–µ–Ω–µ–Ω–∏—è:
- `POST /v1/rag/index/{cabinet_id}` —Ç–µ–ø–µ—Ä—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç **202** –≤–º–µ—Å—Ç–æ **200**
- –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Å—Ç–∞—Ç—É—Å —á–µ—Ä–µ–∑ `GET /v1/rag/status/{cabinet_id}`

### –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:
- ‚úÖ Celery tasks —Å–æ–≤–º–µ—Å—Ç–∏–º—ã (–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç 202 –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ)
- ‚úÖ –°—Ç–∞—Ä—ã–µ –∫–ª–∏–µ–Ω—Ç—ã –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å (–ø—Ä–æ—Å—Ç–æ –Ω–µ –±—É–¥—É—Ç –∂–¥–∞—Ç—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è)

---

## üìà –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –ü–µ—Ä–≤–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è:

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –ü–æ—Å–ª–µ | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|----|----|-----------|
| **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ AI-—Å–µ—Ä–≤–∏—Å–∞** | 201 —Å–µ–∫ | 0 —Å–µ–∫ | ‚úÖ –ù–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ |
| **–û—Ç–≤–µ—Ç API** | 201 —Å–µ–∫ | <100ms | **2000x –±—ã—Å—Ç—Ä–µ–µ** |
| **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã** | –ë–ª–æ–∫–∏—Ä—É—é—Ç—Å—è | –†–∞–±–æ—Ç–∞—é—Ç | ‚úÖ –ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º |
| **–†–µ–∂–∏–º –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏** | incremental ‚ùå | full_rebuild ‚úÖ | –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π |

### –ë–µ–∑–ª–∏–º–∏—Ç–Ω—ã–π —Ä–µ–∂–∏–º:

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –ü–æ—Å–ª–µ |
|---------|----|----|
| **remaining_requests** | `null` ‚ùå | `-1` ‚úÖ |
| **–†–∞–±–æ—Ç–∞–µ—Ç –ª–∏ —á–∞—Ç** | –û—à–∏–±–∫–∞ Pydantic | –†–∞–±–æ—Ç–∞–µ—Ç |

---

## ‚úÖ Checklist –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

- [x] –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞
- [x] –ü–µ—Ä–≤–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ç—Ä–∏–≥–≥–µ—Ä–∏—Ç full_rebuild
- [x] –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ remaining_requests
- [x] –û–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [ ] –°–µ—Ä–≤–∏—Å—ã –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω—ã
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ
- [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–∞—Å—Ç—Ä–æ–µ–Ω

---

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:** –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–µ—Ä—Ç—ã –Ω–∞ –æ—à–∏–±–∫–∏ –≤ —Ñ–æ–Ω–æ–≤–æ–π –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏
2. **–ú–µ—Ç—Ä–∏–∫–∏:** –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –±–∞—Ä –¥–ª—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ (–ø—Ä–æ—Ü–µ–Ω—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è)
3. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:** –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å changed_ids –¥–ª—è event-driven –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏

---

**–ê–≤—Ç–æ—Ä:** Claude Sonnet 4.5
**–î–∞—Ç–∞:** 2025-12-18
**–í–µ—Ä—Å–∏—è:** RAG v1.2.0
**–°—Ç–∞—Ç—É—Å:** ‚úÖ Production Ready
