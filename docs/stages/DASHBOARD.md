# –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º –¥–ª—è –¥–∞—à–±–æ—Ä–¥–∞

–í —ç—Ç–æ–º –¥–æ–∫—É–º–µ–Ω—Ç–µ –æ–ø–∏—Å–∞–Ω—ã —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –∏ –º–µ—Ç–æ–¥—ã –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥-–¥–∞—à–±–æ—Ä–¥–∞.

**–ë–∞–∑–æ–≤—ã–π URL –¥–ª—è –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤:** `http://<SERVER_HOST>/api/v1/bot`  
**–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –¥–æ–ª–∂–Ω—ã —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫ `X-API-SECRET-KEY` —Å –≤–∞–ª–∏–¥–Ω—ã–º –∫–ª—é—á–æ–º.

---

## 1. –û—Å—Ç–∞—Ç–∫–∏ –ø–æ —Å–∫–ª–∞–¥–∞–º

–≠—Ç–æ—Ç —ç–Ω–¥–ø–æ–∏–Ω—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ –æ—Å—Ç–∞—Ç–∫–∞–º —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ –≤—Å–µ—Ö —Å–∫–ª–∞–¥–∞—Ö, —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω—É—é –ø–æ —Ç–æ–≤–∞—Ä–∞–º, –∏—Ö —Ä–∞–∑–º–µ—Ä–∞–º –∏ —Å–∫–ª–∞–¥–∞–º.

- **–≠–Ω–¥–ø–æ–∏–Ω—Ç:** `/stocks/all`
- **–ú–µ—Ç–æ–¥:** `GET`
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
  - `telegram_id` (query, required): ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Telegram.
  - `limit` (query, optional): –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 15).
  - `offset` (query, optional): –°–º–µ—â–µ–Ω–∏–µ –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏.

### –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞

```bash
curl -X GET 'http://127.0.0.1:8000/api/v1/bot/stocks/all?telegram_id=123456789&limit=2' \
-H 'X-API-SECRET-KEY: your_secret_key'
```

### –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞

–û—Ç–≤–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –¥–ª—è Telegram (`telegram_text`) –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –ø–æ–ª–µ `stocks`.

```json
{
  "success": true,
  "telegram_text": "üì¶ *–û—Ç—á–µ—Ç –ø–æ –æ—Å—Ç–∞—Ç–∫–∞–º*\n\n*–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ 1*\n_–ê—Ä—Ç–∏–∫—É–ª: NM-12345_\n\n*–°–∫–ª–∞–¥: –ö–æ–ª–µ–¥–∏–Ω–æ*\n- –†–∞–∑–º–µ—Ä: S, –û—Å—Ç–∞—Ç–æ–∫: 10 —à—Ç.\n- –†–∞–∑–º–µ—Ä: M, –û—Å—Ç–∞—Ç–æ–∫: 15 —à—Ç.\n\n*–°–∫–ª–∞–¥: –ö–∞–∑–∞–Ω—å*\n- –†–∞–∑–º–µ—Ä: S, –û—Å—Ç–∞—Ç–æ–∫: 5 —à—Ç.\n\n*–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ 2*\n_–ê—Ä—Ç–∏–∫—É–ª: NM-67890_\n\n*–°–∫–ª–∞–¥: –ö–æ–ª–µ–¥–∏–Ω–æ*\n- –†–∞–∑–º–µ—Ä: L, –û—Å—Ç–∞—Ç–æ–∫: 20 —à—Ç.\n\n_–ü–æ–∫–∞–∑–∞–Ω–æ 2 –∏–∑ 10 —Ç–æ–≤–∞—Ä–æ–≤._",
  "stocks": {
    "products": [
      {
        "product_name": "–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ 1",
        "vendor_code": "NM-12345",
        "total_stock": 30,
        "warehouses": [
          {
            "warehouse_name": "–ö–æ–ª–µ–¥–∏–Ω–æ",
            "total_stock": 25,
            "sizes": [
              { "size": "S", "stock": 10 },
              { "size": "M", "stock": 15 }
            ]
          },
          {
            "warehouse_name": "–ö–∞–∑–∞–Ω—å",
            "total_stock": 5,
            "sizes": [
              { "size": "S", "stock": 5 }
            ]
          }
        ]
      },
      {
        "product_name": "–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ 2",
        "vendor_code": "NM-67890",
        "total_stock": 20,
        "warehouses": [
          {
            "warehouse_name": "–ö–æ–ª–µ–¥–∏–Ω–æ",
            "total_stock": 20,
            "sizes": [
              { "size": "L", "stock": 20 }
            ]
          }
        ]
      }
    ],
    "pagination": {
      "offset": 0,
      "limit": 2,
      "total": 10,
      "has_more": true
    }
  },
  "status_code": 200
}
```

---

## 2. –î–∞–Ω–Ω—ã–µ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

–≠—Ç–æ—Ç —ç–Ω–¥–ø–æ–∏–Ω—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º, –∑–∞–∫–∞–∑–∞–º, –≤–æ–∑–≤—Ä–∞—Ç–∞–º –∏ –¥—Ä—É–≥–∏–º –º–µ—Ç—Ä–∏–∫–∞–º –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥. –≠—Ç–∏ –¥–∞–Ω–Ω—ã–µ –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤.

- **–≠–Ω–¥–ø–æ–∏–Ω—Ç:** `/analytics/sales`
- **–ú–µ—Ç–æ–¥:** `GET`
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
  - `telegram_id` (query, required): ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Telegram.
  - `period` (query, optional): –ü–µ—Ä–∏–æ–¥ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞. –ù–∞–ø—Ä–∏–º–µ—Ä: `1d`, `7d`, `30d` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `7d`).

### –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞

```bash
curl -X GET 'http://127.0.0.1:8000/api/v1/bot/analytics/sales?telegram_id=123456789&period=7d' \
-H 'X-API-SECRET-KEY: your_secret_key'
```

### –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞

–û—Ç–≤–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é —Ä–∞–∑–±–∏–≤–∫—É –ø–æ –¥–Ω—è–º (–∏–ª–∏ –¥—Ä—É–≥–∏–º –ø–µ—Ä–∏–æ–¥–∞–º), –∫–æ—Ç–æ—Ä–∞—è –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞.

- `orders`: –ó–∞–∫–∞–∑—ã (—Å–æ–∑–¥–∞–Ω—ã)
- `buyouts`: –í—ã–∫—É–ø—ã (–ø—Ä–æ–¥–∞–∂–∏)
- `cancellations`: –û—Ç–º–µ–Ω—ã
- `returns`: –í–æ–∑–≤—Ä–∞—Ç—ã

```json
{
    "success": true,
    "data": {
        "sales_by_day": [
            {
                "date": "2025-11-18",
                "orders": { "count": 10, "amount": 15000 },
                "buyouts": { "count": 8, "amount": 12000 },
                "cancellations": { "count": 1, "amount": 1500 },
                "returns": { "count": 1, "amount": 1500 }
            },
            {
                "date": "2025-11-19",
                "orders": { "count": 12, "amount": 18000 },
                "buyouts": { "count": 10, "amount": 15000 },
                "cancellations": { "count": 2, "amount": 3000 },
                "returns": { "count": 0, "amount": 0 }
            },
            {
                "date": "2025-11-20",
                "orders": { "count": 8, "amount": 11000 },
                "buyouts": { "count": 7, "amount": 9500 },
                "cancellations": { "count": 1, "amount": 1500 },
                "returns": { "count": 0, "amount": 0 }
            },
            {
                "date": "2025-11-21",
                "orders": { "count": 15, "amount": 22000 },
                "buyouts": { "count": 13, "amount": 19000 },
                "cancellations": { "count": 2, "amount": 3000 },
                "returns": { "count": 1, "amount": 2000 }
            },
            {
                "date": "2025-11-22",
                "orders": { "count": 11, "amount": 16500 },
                "buyouts": { "count": 9, "amount": 13500 },
                "cancellations": { "count": 2, "amount": 3000 },
                "returns": { "count": 0, "amount": 0 }
            },
            {
                "date": "2025-11-23",
                "orders": { "count": 14, "amount": 21000 },
                "buyouts": { "count": 11, "amount": 16500 },
                "cancellations": { "count": 2, "amount": 3000 },
                "returns": { "count": 1, "amount": 1500 }
            },
            {
                "date": "2025-11-24",
                "orders": { "count": 18, "amount": 25000 },
                "buyouts": { "count": 15, "amount": 21000 },
                "cancellations": { "count": 3, "amount": 4000 },
                "returns": { "count": 0, "amount": 0 }
            }
        ],
        "totals": {
            "orders": { "count": 88, "amount": 128500 },
            "buyouts": { "count": 73, "amount": 106500 },
            "cancellations": { "count": 13, "amount": 19000 },
            "returns": { "count": 3, "amount": 5000 }
        },
        "dynamics": {
            "average_check": 1458.90,
            "conversion_percent": 82.95
        }
    },
    "telegram_text": "üìà *–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∑–∞ 7 –¥–Ω–µ–π*\n\n*–ó–∞–∫–∞–∑—ã*: 88 –Ω–∞ 128 500 ‚ÇΩ\n*–í—ã–∫—É–ø—ã*: 73 –Ω–∞ 106 500 ‚ÇΩ\n*–û—Ç–º–µ–Ω—ã*: 13 –Ω–∞ 19 000 ‚ÇΩ\n*–í–æ–∑–≤—Ä–∞—Ç—ã*: 3 –Ω–∞ 5 000 ‚ÇΩ\n\n*–°—Ä–µ–¥–Ω–∏–π —á–µ–∫*: 1 459 ‚ÇΩ\n*–ö–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –≤—ã–∫—É–ø (CR)*: 83.0%",
    "status_code": 200
}
```