# üìù AI Chat Service - Changelog

## [1.1.0] - 2025-10-29 - –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è –∏ —É–ª—É—á—à–µ–Ω–∏—è UX

### ‚ú® –î–æ–±–∞–≤–ª–µ–Ω–æ

#### üéØ –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤
- **–î–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** –∏–∑ –æ—Å–Ω–æ–≤–Ω–æ–π –ë–î
  - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–¥–∞–∂ –∑–∞ 7 –¥–Ω–µ–π
  - –î–∞–Ω–Ω—ã–µ –æ –∑–∞–∫–∞–∑–∞—Ö (–Ω–æ–≤—ã–µ, –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ)
  - –û—Å—Ç–∞—Ç–∫–∏ –Ω–∞ —Å–∫–ª–∞–¥–µ (–∫—Ä–∏—Ç–∏—á–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏)
  - –û—Ç–∑—ã–≤—ã –∏ —Ä–µ–π—Ç–∏–Ω–≥–∏
  - –¢–æ–ø-3 —Ç–æ–≤–∞—Ä–∞ –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º

- **–§—É–Ω–∫—Ü–∏—è `get_user_context()`** –≤ `bot/handlers/ai_chat.py`
  - –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ `bot_api_client`
  - –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–ª—è AI
  - Graceful fallback –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö

- **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ `user_context`** –≤ AI Chat Service
  - –ù–æ–≤–æ–µ –ø–æ–ª–µ –≤ `ChatSendRequest` schema
  - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –≤ –ø—Ä–æ–º–ø—Ç OpenAI
  - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

- **–û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç**
  - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤
  - –ü—Ä–∞–≤–∏–ª–∞ —Ä–∞–±–æ—Ç—ã —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - –°—Å—ã–ª–∫–∞ –Ω–∞ AI-–∞–Ω–∞–ª–∏–∑ –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω—ã—Ö –æ—Ç—á–µ—Ç–æ–≤

#### üé® UX —É–ª—É—á—à–µ–Ω–∏—è
- **–ö–Ω–æ–ø–∫–∞ "üí¨ AI-—á–∞—Ç"** –≤ –º–µ–Ω—é "ü§ñ AI-–ø–æ–º–æ—â–Ω–∏–∫"
  - –í–º–µ—Å—Ç–æ –∫–æ–º–∞–Ω–¥—ã `/ai_chat`
  - –ò–Ω—Ç—É–∏—Ç–∏–≤–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è —á–µ—Ä–µ–∑ –º–µ–Ω—é

- **–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ –≤ —Ä–µ–∂–∏–º–µ —á–∞—Ç–∞**
  - üîô –í—ã–π—Ç–∏ –∏–∑ —á–∞—Ç–∞ - –≤–æ–∑–≤—Ä–∞—Ç –≤ –º–µ–Ω—é
  - üìä –ú–æ–∏ –ª–∏–º–∏—Ç—ã - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–æ–≤ –±–µ–∑ –≤—ã—Ö–æ–¥–∞

- **–û–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ**
  - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏
  - –£–ø–æ–º–∏–Ω–∞–Ω–∏–µ AI-–∞–Ω–∞–ª–∏–∑–∞ (–∫–Ω–æ–ø–∫–∞ "üß† AI-–∞–Ω–∞–ª–∏–∑")
  - –ë–æ–ª–µ–µ –ø–æ–Ω—è—Ç–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

### üîÑ –ò–∑–º–µ–Ω–µ–Ω–æ

#### Bot Handler (`bot/handlers/ai_chat.py`)
- –ö–æ–º–∞–Ω–¥–∞ `/ai_chat` ‚Üí callback `ai_chat`
- –ö–æ–º–∞–Ω–¥–∞ `/cancel` ‚Üí callback `cancel_ai_chat`
- –î–æ–±–∞–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç `bot_api_client`
- –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `get_user_context(telegram_id)`
- –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `user_context` –≤ payload

#### AI Chat Service (`ai_chat/service.py`)
- Endpoint `/v1/chat/send` –ø—Ä–∏–Ω–∏–º–∞–µ—Ç `user_context`
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –≤ –ø—Ä–æ–º–ø—Ç OpenAI
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞–ª–∏—á–∏—è –∏ —Ä–∞–∑–º–µ—Ä–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

#### Schemas (`ai_chat/schemas.py`)
- `ChatSendRequest` –≤–∫–ª—é—á–∞–µ—Ç `user_context: Optional[str]`

#### Prompts (`ai_chat/prompts.py`)
- –î–æ–±–∞–≤–ª–µ–Ω –ø—É–Ω–∫—Ç "7. –ü–ï–†–°–û–ù–ê–õ–ò–ó–ê–¶–ò–Ø –û–¢–í–ï–¢–û–í"
- –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Å—Å—ã–ª–∫–∞ —Å `/digest` –Ω–∞ "üß† AI-–∞–Ω–∞–ª–∏–∑"

#### Keyboards (`bot/keyboards/keyboards.py`)
- `ai_assistant_keyboard()` –≤–∫–ª—é—á–∞–µ—Ç –∫–Ω–æ–ø–∫—É "üí¨ AI-—á–∞—Ç"

### ‚ùå –£–¥–∞–ª–µ–Ω–æ

- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ç–æ–∫–µ–Ω–æ–≤ –≤ –æ—Ç–≤–µ—Ç–∞—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
  - –ë—ã–ª–æ: `"–û—Å—Ç–∞–ª–æ—Å—å –∑–∞–ø—Ä–æ—Å–æ–≤: 28/30 ‚Ä¢ –¢–æ–∫–µ–Ω–æ–≤: 150"`
  - –°—Ç–∞–ª–æ: `"–û—Å—Ç–∞–ª–æ—Å—å –∑–∞–ø—Ä–æ—Å–æ–≤: 28/30"`

- Command handler `@router.message(Command("ai_chat", "chat"))`
  - –ó–∞–º–µ–Ω–µ–Ω –Ω–∞ callback handler

### üêõ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

- –ù–∞–≤–∏–≥–∞—Ü–∏—è —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫–∏ –º–µ–Ω—é
- –ë–æ–ª–µ–µ –ø–æ–Ω—è—Ç–Ω—ã–π –ø—É—Ç—å –∫ AI —á–∞—Ç—É –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **–°–æ–∑–¥–∞–Ω:** `ai_chat/PERSONALIZATION_GUIDE.md` - –ø–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏
- **–û–±–Ω–æ–≤–ª–µ–Ω:** `ai_chat/TELEGRAM_TEST_GUIDE.md` - –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
- **–û–±–Ω–æ–≤–ª–µ–Ω:** `ai_chat/UPDATES.md` - –¥–µ—Ç–∞–ª–∏ –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
- **–°–æ–∑–¥–∞–Ω:** `ai_chat/CHANGELOG.md` - —ç—Ç–æ—Ç —Ñ–∞–π–ª

---

## [1.0.1] - 2025-10-29 - UX —É–ª—É—á—à–µ–Ω–∏—è

### ‚ú® –î–æ–±–∞–≤–ª–µ–Ω–æ
- –ö–Ω–æ–ø–∫–∞ "üí¨ AI-—á–∞—Ç" –≤ –º–µ–Ω—é AI-–ø–æ–º–æ—â–Ω–∏–∫–∞
- –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ –≤ —Ä–µ–∂–∏–º–µ —á–∞—Ç–∞ (–í—ã–π—Ç–∏, –ú–æ–∏ –ª–∏–º–∏—Ç—ã)

### üîÑ –ò–∑–º–µ–Ω–µ–Ω–æ
- –ö–æ–º–∞–Ω–¥–∞ `/ai_chat` –∑–∞–º–µ–Ω–µ–Ω–∞ –Ω–∞ –∫–Ω–æ–ø–∫—É
- –ö–æ–º–∞–Ω–¥–∞ `/cancel` –∑–∞–º–µ–Ω–µ–Ω–∞ –Ω–∞ –∫–Ω–æ–ø–∫—É "–í—ã–π—Ç–∏ –∏–∑ —á–∞—Ç–∞"

### ‚ùå –£–¥–∞–ª–µ–Ω–æ
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

---

## [1.0.0] - 2025-10-26 - –ü–µ—Ä–≤—ã–π —Ä–µ–ª–∏–∑

### ‚ú® –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **REST API** –Ω–∞ FastAPI (–ø–æ—Ä—Ç 9001)
- **Rate limiting** - 30 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å—É—Ç–∫–∏ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è** - –ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 —Å–æ–æ–±—â–µ–Ω–∏–π
- **–¢–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è** - —Ç–æ–ª—å–∫–æ Wildberries –∏ e-commerce
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å OpenAI** - gpt-4o-mini
- **PostgreSQL/SQLite** –ø–æ–¥–¥–µ—Ä–∂–∫–∞
- **Docker** –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è

### üìä API Endpoints

- `GET /health` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
- `POST /v1/chat/send` - –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
- `POST /v1/chat/history` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏
- `GET /v1/chat/limits/{telegram_id}` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–æ–≤
- `POST /v1/chat/reset-limit` - —Å–±—Ä–æ—Å –ª–∏–º–∏—Ç–∞ (admin)
- `GET /v1/chat/stats/{telegram_id}` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- API Key –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- Rate limiting –ø–æ telegram_id
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (Pydantic)

### üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

- Unit —Ç–µ—Å—Ç—ã –¥–ª—è CRUD –æ–ø–µ—Ä–∞—Ü–∏–π
- Integration —Ç–µ—Å—Ç—ã –¥–ª—è API endpoints
- 47 —Ç–µ—Å—Ç–æ–≤, 100% coverage –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—É—Ç–µ–π

---

## –§–æ—Ä–º–∞—Ç –≤–µ—Ä—Å–∏–π

–ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º [Semantic Versioning](https://semver.org/):
- **MAJOR** –≤–µ—Ä—Å–∏—è - –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è API
- **MINOR** –≤–µ—Ä—Å–∏—è - –Ω–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Å –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å—é
- **PATCH** –≤–µ—Ä—Å–∏—è - –æ–±—Ä–∞—Ç–Ω–æ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

---

## –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π

- **‚ú® –î–æ–±–∞–≤–ª–µ–Ω–æ** - –Ω–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- **üîÑ –ò–∑–º–µ–Ω–µ–Ω–æ** - –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
- **‚ùå –£–¥–∞–ª–µ–Ω–æ** - —É–¥–∞–ª–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- **üêõ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ** - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–≥–æ–≤
- **üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
- **üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
- **‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - —É–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

