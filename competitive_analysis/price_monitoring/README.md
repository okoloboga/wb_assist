# –ú–æ–¥—É–ª—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Ü–µ–Ω –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤

–ú–æ–¥—É–ª—å –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Ü–µ–Ω –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤ —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π Google Sheets API, –∞–Ω–∞–ª–∏–∑–æ–º —Ü–µ–Ω–æ–≤—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –∏ —Å–∏—Å—Ç–µ–º–æ–π —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üîç **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ü–µ–Ω –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–±–æ—Ä –∏ –∞–Ω–∞–ª–∏–∑ —Ü–µ–Ω–æ–≤–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- üìä **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Google Sheets** - —Å–æ–∑–¥–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü–∞–º–∏ –¥–ª—è –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏
- üìà **–ê–Ω–∞–ª–∏–∑ —Ü–µ–Ω–æ–≤—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π** - —Ä–∞—Å—á–µ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –ø–æ —Ü–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—é
- üîî **–°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π** - –æ–ø–æ–≤–µ—â–µ–Ω–∏—è –æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö —Ü–µ–Ω
- ‚öôÔ∏è **–ì–∏–±–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π
- üß™ **–ü–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–æ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ** - unit –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
price_monitoring/
‚îú‚îÄ‚îÄ __init__.py                 # –û—Å–Ω–æ–≤–Ω–æ–π –º–æ–¥—É–ª—å
‚îú‚îÄ‚îÄ config/                     # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ settings.py            # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–¥—É–ª—è
‚îÇ   ‚îî‚îÄ‚îÄ config.json            # –§–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ core/                      # –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îî‚îÄ‚îÄ google_sheets_client.py # –ö–ª–∏–µ–Ω—Ç Google Sheets API
‚îú‚îÄ‚îÄ models/                    # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îî‚îÄ‚îÄ product.py            # –ú–æ–¥–µ–ª—å –ø—Ä–æ–¥—É–∫—Ç–∞
‚îú‚îÄ‚îÄ utils/                     # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îî‚îÄ‚îÄ auth_helper.py        # –ü–æ–º–æ—â–Ω–∏–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ templates/                 # –®–∞–±–ª–æ–Ω—ã –æ—Ç—á–µ—Ç–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ __init__.py
‚îú‚îÄ‚îÄ tests/                     # –¢–µ—Å—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ test_google_sheets_client.py
‚îÇ   ‚îú‚îÄ‚îÄ test_auth_helper.py
‚îÇ   ‚îú‚îÄ‚îÄ test_models.py
‚îÇ   ‚îú‚îÄ‚îÄ test_settings.py
‚îÇ   ‚îî‚îÄ‚îÄ test_integration.py
‚îú‚îÄ‚îÄ requirements.txt           # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îî‚îÄ‚îÄ README.md                 # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. **–ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:**
```bash
cd competitive_analysis/price_monitoring
pip install -r requirements.txt
```

2. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Google Sheets API:**
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ [Google Cloud Console](https://console.cloud.google.com/)
   - –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π
   - –í–∫–ª—é—á–∏—Ç–µ Google Sheets API –∏ Google Drive API
   - –°–æ–∑–¥–∞–π—Ç–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ OAuth 2.0
   - –°–∫–∞—á–∞–π—Ç–µ —Ñ–∞–π–ª `credentials.json` –≤ –ø–∞–ø–∫—É `config/`

3. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –º–æ–¥—É–ª—è:**
```python
from config.settings import Settings

# –°–æ–∑–¥–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
settings = Settings(config_dir='path/to/config')
settings.monitoring.update_interval_hours = 6
settings.notifications.email_enabled = True
settings.save_config()
```

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```python
from price_monitoring import GoogleSheetsClient, Product
from utils.auth_helper import AuthHelper
from config.settings import get_settings

# –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫
settings = get_settings()

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
auth_helper = AuthHelper(
    credentials_file=str(settings.get_credentials_path()),
    token_file=str(settings.get_token_path()),
    scopes=settings.google_sheets.scopes
)

# –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞ Google Sheets
client = GoogleSheetsClient(auth_helper=auth_helper)

# –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
product = Product(
    id="PROD001",
    name="iPhone 15 Pro",
    brand="Apple",
    current_price=99990.0,
    competitor_prices=[95000.0, 102000.0, 98500.0]
)

# –ê–Ω–∞–ª–∏–∑ —Ü–µ–Ω–æ–≤–æ–π –ø–æ–∑–∏—Ü–∏–∏
recommendations = product.get_pricing_recommendations()
print(f"–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: {recommendations['action']}")
print(f"–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Ü–µ–Ω–∞: {recommendations['recommended_price']}")
```

### 2. –†–∞–±–æ—Ç–∞ —Å Google Sheets

```python
# –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π —Ç–∞–±–ª–∏—Ü—ã
spreadsheet = client.create_spreadsheet("–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ü–µ–Ω - –Ø–Ω–≤–∞—Ä—å 2024")
spreadsheet_id = spreadsheet['spreadsheetId']

# –ó–∞–ø–∏—Å—å –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
headers = Product.get_sheets_headers()
client.update_values(
    spreadsheet_id=spreadsheet_id,
    range_name='A1:J1',
    values=[headers]
)

# –ó–∞–ø–∏—Å—å –¥–∞–Ω–Ω—ã—Ö –æ –ø—Ä–æ–¥—É–∫—Ç–∞—Ö
products = [product1, product2, product3]  # –í–∞—à–∏ –ø—Ä–æ–¥—É–∫—Ç—ã
product_rows = [p.to_sheets_row() for p in products]
client.update_values(
    spreadsheet_id=spreadsheet_id,
    range_name='A2:J4',
    values=product_rows
)

# –ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
data = client.read_values(
    spreadsheet_id=spreadsheet_id,
    range_name='A1:J10'
)
```

### 3. –ü–∞–∫–µ—Ç–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

```python
# –ü–∞–∫–µ—Ç–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–ª—è –±–æ–ª—å—à–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤
batch_data = []
for i, product in enumerate(products):
    batch_data.append({
        'range': f'A{i+2}:J{i+2}',
        'values': [product.to_sheets_row()]
    })

result = client.batch_update_values(
    spreadsheet_id=spreadsheet_id,
    value_input_data=batch_data
)

print(f"–û–±–Ω–æ–≤–ª–µ–Ω–æ —Å—Ç—Ä–æ–∫: {result['totalUpdatedRows']}")
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

```python
# config/settings.py
settings = Settings()

# Google Sheets API
settings.google_sheets.application_name = "My Price Monitor"
settings.google_sheets.batch_size = 100
settings.google_sheets.request_timeout = 30

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
settings.monitoring.update_interval_hours = 6
settings.monitoring.price_change_threshold_percent = 5.0
settings.monitoring.enable_notifications = True

# –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
settings.notifications.email_enabled = True
settings.notifications.email_recipients = ["admin@company.com"]
settings.notifications.telegram_enabled = False

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫
settings.save_config()
```

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–í—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:

```bash
export GOOGLE_SHEETS_APPLICATION_NAME="Production Price Monitor"
export MONITORING_UPDATE_INTERVAL_HOURS=4
export NOTIFICATIONS_EMAIL_ENABLED=true
export NOTIFICATIONS_EMAIL_RECIPIENTS="admin@company.com,manager@company.com"
```

## API Reference

### GoogleSheetsClient

–û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Google Sheets API.

```python
class GoogleSheetsClient:
    def __init__(self, auth_helper: AuthHelper, application_name: str = None)
    
    def create_spreadsheet(self, title: str) -> dict
    def get_spreadsheet_info(self, spreadsheet_id: str) -> dict
    def read_values(self, spreadsheet_id: str, range_name: str) -> list
    def update_values(self, spreadsheet_id: str, range_name: str, values: list) -> dict
    def batch_update_values(self, spreadsheet_id: str, value_input_data: list) -> dict
    def batch_get_values(self, spreadsheet_id: str, ranges: list) -> list
```

### Product

–ú–æ–¥–µ–ª—å –ø—Ä–æ–¥—É–∫—Ç–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ü–µ–Ω.

```python
class Product:
    def __init__(self, id: str, name: str, brand: str, current_price: float, 
                 competitor_prices: list = None)
    
    # –ê–Ω–∞–ª–∏–∑ —Ü–µ–Ω
    def get_min_competitor_price(self) -> float
    def get_max_competitor_price(self) -> float
    def get_average_competitor_price(self) -> float
    def get_median_competitor_price(self) -> float
    def get_price_position(self) -> str
    def is_price_competitive(self, threshold_percent: float = 10.0) -> bool
    def get_pricing_recommendations(self) -> dict
    
    # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏
    def add_competitor_price(self, price: float)
    def remove_competitor_price(self, price: float)
    def update_current_price(self, new_price: float)
    
    # –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è
    def to_dict(self) -> dict
    def from_dict(cls, data: dict) -> 'Product'
    def to_json(self) -> str
    def from_json(cls, json_str: str) -> 'Product'
    def to_sheets_row(self) -> list
    def get_sheets_headers(cls) -> list
```

### AuthHelper

–ü–æ–º–æ—â–Ω–∏–∫ –¥–ª—è OAuth 2.0 –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

```python
class AuthHelper:
    def __init__(self, credentials_file: str, token_file: str, scopes: list = None)
    
    def get_credentials(self) -> Credentials
    def save_credentials(self, credentials: Credentials)
    def refresh_credentials(self) -> Credentials
    def revoke_credentials(self)
    def get_sheets_service(self) -> Resource
    def get_drive_service(self) -> Resource
    def test_connection(self) -> bool
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤:

```bash
cd price_monitoring
python -m pytest tests/ -v
```

–ó–∞–ø—É—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞:

```bash
python -m pytest tests/test_google_sheets_client.py -v
```

–ó–∞–ø—É—Å–∫ —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º –∫–æ–¥–∞:

```bash
python -m pytest tests/ --cov=. --cov-report=html
```

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ê–Ω–∞–ª–∏–∑ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

```python
# –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞
product = Product(
    id="LAPTOP001",
    name="MacBook Pro 14\"",
    brand="Apple",
    current_price=199990.0,
    competitor_prices=[189990.0, 205000.0, 195000.0, 210000.0]
)

# –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
print(f"–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤: {product.get_min_competitor_price()}")
print(f"–°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤: {product.get_average_competitor_price()}")
print(f"–ü–æ–∑–∏—Ü–∏—è –ø–æ —Ü–µ–Ω–µ: {product.get_price_position()}")

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
if product.is_price_competitive(threshold_percent=5.0):
    print("–¶–µ–Ω–∞ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ—Å–ø–æ—Å–æ–±–Ω–∞")
else:
    recommendations = product.get_pricing_recommendations()
    print(f"–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: {recommendations['action']}")
    print(f"–ù–æ–≤–∞—è —Ü–µ–Ω–∞: {recommendations['recommended_price']}")
```

### –ú–∞—Å—Å–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤

```python
# –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –∏–∑ Google Sheets
data = client.read_values(spreadsheet_id, 'A2:J100')

products = []
for row in data:
    if len(row) >= 10:  # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –≤—Å–µ—Ö –∫–æ–ª–æ–Ω–æ–∫
        product = Product(
            id=row[0],
            name=row[1],
            brand=row[2],
            current_price=float(row[3]),
            competitor_prices=json.loads(row[4]) if row[4] else []
        )
        products.append(product)

# –ê–Ω–∞–ª–∏–∑ –≤—Å–µ—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤
for product in products:
    recommendations = product.get_pricing_recommendations()
    if recommendations['action'] != 'maintain':
        print(f"{product.name}: {recommendations['action']} -> {recommendations['recommended_price']}")
```

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ issues –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞.